<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Security Map</title>
    <link rel="icon" href="/favicon.ico" />

    <style>
      /* صفحة كاملة وخريطة ممتدة */
      html, body { height: 100%; margin: 0; }
      body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans Arabic", Arial, sans-serif; background:#0b0f14; }
      #map {
        position: fixed; inset: 0; z-index: 1;
        min-height: 100vh; min-width: 100vw;
      }

      /* لوحة تحكم زجاجية أعلى يمين */
      .toolbar {
        position: fixed; top: 14px; right: 14px; z-index: 10;
        background: rgba(22,22,24,0.55); color:#fff;
        border: 1px solid rgba(255,255,255,0.12);
        backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px);
        border-radius: 14px; padding: 8px; display: flex; gap: 6px; align-items: center;
      }
      .btn {
        height: 34px; padding: 0 10px; border-radius: 10px; cursor: pointer;
        border: 1px solid rgba(255,255,255,0.18); background: rgba(255,255,255,0.08); color:#fff;
      }
      .btn[aria-pressed="true"] { background: rgba(255,255,255,0.22); }
      .btn.secondary { background: rgba(255,255,255,0.06); }
      .badge { font-size:12px; padding:2px 8px; border-radius:8px; border:1px solid rgba(255,255,255,.18) }
      .badge-share { background: rgba(255,255,255,0.08); color:#fff; }
      .badge-edit  { background: #1f5a1f; border-color:#2d7a2d; color:#d8ffd8; }

      /* مودال المستلمين العامّين */
      .modal.hidden { display: none; }
      .modal { position: fixed; inset: 0; z-index: 20; display: grid; place-items: center; background: rgba(0,0,0,0.35); }
      .modal .modal-content {
        width: min(560px, 92vw); background: rgba(22,22,24,0.8); color:#fff;
        border:1px solid rgba(255,255,255,0.12); border-radius: 16px; padding: 14px;
        backdrop-filter: blur(12px);
      }
      .modal .txt { width:100%; border-radius:10px; border:1px solid rgba(255,255,255,.18); background: rgba(255,255,255,.06); color:#fff; padding:8px; }

      /* Toast */
      .toast { position: fixed; right: 14px; bottom: 14px; z-index: 15; background: rgba(22,22,24,0.85);
        color:#fff; border:1px solid rgba(255,255,255,.12); padding:8px 12px; border-radius:10px; backdrop-filter: blur(10px); }
      .toast.hidden { display:none; }

      /* اسمح للـ InfoWindow بوضع محتوى مخصص */
      .gm-style-iw-d { overflow: visible !important; }
    </style>
  </head>
  <body>
    <!-- الخريطة -->
    <div id="map" role="application" aria-label="خريطة تفاعلية"></div>

    <!-- لوحة التحكم -->
    <div class="toolbar" id="toolbar">
      <span id="modeBadge" class="badge badge-share">Share</span>
      <button id="btnRoadmap" class="btn" aria-pressed="true">طرق</button>
      <button id="btnSatellite" class="btn" aria-pressed="false">قمر صناعي</button>
      <button id="btnTraffic" class="btn" aria-pressed="false">حركة المرور</button>
      <button id="btnRecipients" class="btn secondary">المستلمون</button>
      <button id="btnEditMode" class="btn secondary">تحرير</button>
    </div>

    <!-- محرّر المستلمين العامّين (اختياري) -->
    <div id="recipientsModal" class="modal hidden" aria-hidden="true" role="dialog">
      <div class="modal-content">
        <h3 style="margin-top:0">تعديل المستلمين العامّين</h3>
        <p style="margin:4px 0 8px; opacity:.85">أدخل البريد/الأرقام (مفصولة بفواصل):</p>
        <textarea id="recipientsInput" rows="5" class="txt"></textarea>
        <div style="display:flex; gap:8px; justify-content:flex-start; margin-top:10px">
          <button id="saveRecipients" class="btn">حفظ</button>
          <button id="cancelRecipients" class="btn secondary">إلغاء</button>
        </div>
      </div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast hidden"></div>

    <!-- سكربتات -->
    <script src="js/main.js" defer></script>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjX9UJKG53r5ymGydlWEMNbuvi234LcC8&v=weekly&libraries=geometry&callback=initMap"
      async
      defer
    ></script>
  </body>
</html>
