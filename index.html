<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Security Map â€“ Share/Edit</title>

    <link rel="icon" href="/favicon.ico" />
    <link rel="stylesheet" href="css/style.css" />

    <!-- Fallback Ø§Ø±ØªÙØ§Ø¹ Ù„Ù„Ø®Ø±ÙŠØ·Ø© Ù„Ùˆ ØªØ¹Ø·Ù„ CSS Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠ -->
    <style>
      #map{min-height:calc(100vh - 60px);}
      @media (max-width:640px){#map{min-height:calc(100vh - 56px);}}
      /* Ø¥Ø¶Ø§ÙØ§Øª Ø¨Ø³ÙŠØ·Ø© Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ­Ø±ÙŠØ± */
      .gear-btn{background:#222;border:1px solid #333;color:#eee;padding:6px 8px;border-radius:10px;cursor:pointer}
      .edit-dropdown{position:absolute;top:10px;left:10px;background:#161616;border:1px solid #2a2a2a;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.35);padding:10px;width:min(320px,92vw);display:none;z-index:11}
      .edit-dropdown.open{display:block}
      .row{display:flex;align-items:center;gap:10px;margin:8px 0}
      .row label{min-width:90px;color:#ddd}
      .row input[type="color"]{width:40px;height:28px;border:none;background:none;padding:0}
      .row input[type="range"]{flex:1}
      .row textarea{width:100%;background:#111;color:#eee;border:1px solid #2a2a2a;border-radius:10px;padding:8px}
      .actions{display:flex;gap:8px;justify-content:flex-start;margin-top:6px}
      .badge-edit{font-size:12px;color:#0f0;background:#123a12;border:1px solid #1f5a1f;border-radius:8px;padding:2px 8px;margin-top:4px}
      .badge-share{font-size:12px;color:#ddd;background:#2a2a2a;border:1px solid #333;border-radius:8px;padding:2px 8px;margin-top:4px}
    </style>
  </head>
  <body>
    <div id="app">
      <header class="topbar">
        <div class="brand">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Diriyah_Company_Logo.svg/512px-Diriyah_Company_Logo.svg.png" alt="Diriyah" class="brand-logo" />
          <div class="brand-text">
            <strong>Security & Traffic Map</strong>
            <span id="modeBadge" class="mode-badge">Share</span>
          </div>
        </div>

        <div class="controls">
          <button id="btnRoadmap" class="btn" aria-pressed="true">Ø·Ø±Ù‚</button>
          <button id="btnSatellite" class="btn" aria-pressed="false">Ù‚Ù…Ø± ØµÙ†Ø§Ø¹ÙŠ</button>
          <button id="btnTraffic" class="btn" aria-pressed="false">Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø±ÙˆØ±</button>
          <button id="btnRecipients" class="btn secondary" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù…ÙŠÙ†">Ø§Ù„Ù…Ø³ØªÙ„Ù…ÙˆÙ†</button>
          <!-- Ø²Ø± ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø±ÙŠØ± (ÙŠØ®ØªÙÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©) -->
          <button id="btnEditMode" class="btn secondary" title="ØªÙØ¹ÙŠÙ„/Ø¥Ù„ØºØ§Ø¡ ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø±ÙŠØ±">ØªØ­Ø±ÙŠØ±</button>
        </div>
      </header>

      <div id="map" role="application" aria-label="Ø®Ø±ÙŠØ·Ø© ØªÙØ§Ø¹Ù„ÙŠØ©"></div>

      <!-- ÙƒØ±Øª Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª -->
      <aside id="infoCard" class="info-card hidden" role="dialog" aria-live="polite">
        <div class="info-header">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Diriyah_Company_Logo.svg/512px-Diriyah_Company_Logo.svg.png" alt="Diriyah" class="info-logo" />
          <div class="info-titles">
            <h3 id="infoTitle">â€”</h3>
            <p id="infoSubtitle" class="muted">â€”</p>
          </div>
          <!-- Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© (ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· ÙÙŠ ÙˆØ¶Ø¹ Ø§Ù„ØªØ­Ø±ÙŠØ± ÙˆØ¹Ù†Ø¯ ØªØ­Ø¯ÙŠØ¯ Ø¯Ø§Ø¦Ø±Ø©) -->
          <button id="gearBtn" class="gear-btn" title="Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©">âš™ï¸</button>
          <button id="pinCard" class="icon-btn" title="ØªØ«Ø¨ÙŠØª Ø§Ù„ÙƒØ±Øª">ğŸ“Œ</button>
          <button id="closeCard" class="icon-btn" title="Ø¥ØºÙ„Ø§Ù‚">âœ•</button>
        </div>
        <div class="info-body">
          <ul class="info-list">
            <li><strong>Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª:</strong> <span id="infoLatLng">â€”</span></li>
            <li><strong>Ù†ØµÙ Ø§Ù„Ù‚Ø·Ø±:</strong> <span id="infoRadius">15 Ù…</span></li>
            <li id="infoNotesRow" class="hidden"><strong>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong> <span id="infoNotes">â€”</span></li>
          </ul>

          <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø© Ù„Ù„ØªØ­Ø±ÙŠØ± -->
          <div id="editDropdown" class="edit-dropdown" aria-hidden="true">
            <div class="row">
              <label>Ø§Ù„Ù„ÙˆÙ†:</label>
              <input id="editColor" type="color" value="#c1a476" />
            </div>
            <div class="row">
              <label>Ù†ØµÙ Ø§Ù„Ù‚Ø·Ø±:</label>
              <input id="editRadius" type="range" min="5" max="300" step="1" />
              <span id="editRadiusVal">15</span><span>Ù…</span>
            </div>
            <div class="row" style="align-items:flex-start">
              <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</label>
              <textarea id="editNotes" rows="3" placeholder="â€”"></textarea>
            </div>
            <div class="actions">
              <button id="btnSaveCircle" class="btn">Ø­ÙØ¸</button>
              <button id="btnDeleteCircle" class="btn secondary">Ø­Ø°Ù</button>
              <button id="btnCloseDropdown" class="btn secondary">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
          </div>
        </div>
      </aside>

      <!-- Ù…Ø­Ø±Ù‘Ø± Ø§Ù„Ù…Ø³ØªÙ„Ù…ÙŠÙ† -->
      <div id="recipientsModal" class="modal hidden" aria-hidden="true" role="dialog">
        <div class="modal-content">
          <div class="modal-header"><h3>ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù…ÙŠÙ†</h3></div>
          <div class="modal-body">
            <label for="recipientsInput" class="lbl">Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯/Ø§Ù„Ø£Ø±Ù‚Ø§Ù… (Ù…ÙØµÙˆÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„):</label>
            <textarea id="recipientsInput" rows="5" class="txt"></textarea>
            <p class="hint">ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸ Ù…Ø­Ù„ÙŠÙ‹Ø§ ÙˆÙŠÙØ¶Ù…Ù‘ÙÙ† Ø£ÙŠØ¶Ù‹Ø§ Ø¯Ø§Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„Ù…Ø®ØªØµØ±.</p>
          </div>
          <div class="modal-actions">
            <button id="saveRecipients" class="btn">Ø­ÙØ¸</button>
            <button id="cancelRecipients" class="btn secondary">Ø¥Ù„ØºØ§Ø¡</button>
          </div>
        </div>
      </div>

      <div id="toast" class="toast hidden"></div>
    </div>

    <!-- ØªØ±ØªÙŠØ¨ Ø§Ù„ØªØ­Ù…ÙŠÙ„ (Ø§Ù„Ù…Ù‡Ù…) -->
    <script src="js/main.js" defer></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjX9UJKG53r5ymGydlWEMNbuvi234LcC8&libraries=geometry&callback=initMap" defer></script>
  </body>
</html>
